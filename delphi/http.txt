
procedure TfrmTools.getRequest(Url : string);
  var
   IdHttp : TIdHTTP;
   ResponseStream : TStringStream; //返回信息
   ResponseStr : string;
  begin
   //创建IDHTTP控件
   IdHttp := TIdHTTP.Create(nil);
   //TStringStream对象用于保存响应信息
   ResponseStream := TStringStream.Create('');
   try
     try
       IdHttp.Get(Url,ResponseStream);
     except
       on e : Exception do
       begin
         ShowMessage(e.Message);
       end;
     end;
     //获取网页返回的信息
     ResponseStr := ResponseStream.DataString;
     //网页中的存在中文时，需要进行UTF8解码
     ResponseStr := UTF8Decode(ResponseStr);
   finally
     IdHttp.Free;
     ResponseStream.Free;
   end;
  end;

procedure TfrmTools.PostReqeust(Url : string; param: TJsonObject; ResponseStream : TMemoryStream);
var
  IdHttp : TIdHTTP;
  ResponseStr ,key,value: string;
  RequestList : TStringList;     //请求信息
  RequestStream : TStringStream;
  i: integer;
  rs : TStringStream; //返回信息
begin
  //创建IDHTTP控件
  IdHttp := TIdHTTP.Create(nil);
  //TStringStream对象用于保存响应信息
  rs := TStringStream.Create('');
  RequestStream := TStringStream.Create('');
  RequestList := TStringList.Create;
  try
    try
      //以列表的方式提交参数
      for i := 0 to param.Size - 1 do
      begin
        key := StringReplace(TJSONPair(param.Get(i)).JsonString.ToString, '"', '', [rfReplaceAll]);
        value := param.GetValue(key).ToString;
        Delete(value, 1, 1);
        Delete(value, value.length, 1);
        RequestList.Add(key + '=' + HttpEncode(value));
      end;
      IdHttp.Post(Url, RequestList, ResponseStream);
      // key := rs.DataString;

      //以流的方式提交参数
      //RequestStream.WriteString('text=love');
      //IdHttp.Post(Url,RequestStream,ResponseStream);
    except
      on e : Exception do
      begin
        ShowMessage(e.Message);
      end;
    end;
    //获取网页返回的信息
    //ResponseStr := ResponseStream.DataString;
    //网页中的存在中文时，需要进行UTF8解码
    //ResponseStr := UTF8Decode(ResponseStr);
  finally
    IdHttp.Free;
    RequestList.Free;
    RequestStream.Free;
  end;
end;