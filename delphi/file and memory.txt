ms := TMemoryStream.Create();
ms.WriteBuffer((PChar('字符串'))^, Length(str));  
ms.SaveToFile('d:\2.txt');
ms.Free;

// 创建目录
if not DirectoryExists(ExtractFileDir(localFile)) then ForceDirectories(ExtractFileDir(localFile));

if FileExists(docPath) then
      DeleteFile(docPath);

procedure TwordOperateFrame.debugLog(log:string);
var
  F: TextFile;
  filePath:string;
begin
  filePath := ExtractFileDir(ParamStr(0)) + '\logs\debug' + FormatDateTime('yyyy-mm-dd',Now()) + '.log';
  if(not DirectoryExists(ExtractFilePath(filePath))) then
  begin
    ForceDirectories(ExtractFilePath(filePath));
  end;
  AssignFile(F, filePath);
  if(not FileExists(filePath)) then
  begin
    rewrite(F);
  end else begin
    Append(F);  //打开准备追加
  end;
  Writeln(F, FormatDateTime('yyyy-mm-dd hh:nn:ss',Now()));
  Writeln(F, log);
  CloseFile(F);
end;